{%- if card_product and card_product != empty -%}
  {%- liquid
    assign ratio = 1
    if card_product.featured_media and media_aspect_ratio == 'portrait'
      assign ratio = 0.8
    elsif card_product.featured_media and media_aspect_ratio == 'adapt'
      assign ratio = card_product.featured_media.aspect_ratio
    endif
    if ratio == 0 or ratio == null
      assign ratio = 1
    endif
  -%}
  <div class="card-wrapper product-card-wrapper underline-links-hover">
    <div
      class="
        card card--{{ settings.card_style }}
        {% if card_product.featured_media %} card--media{% else %} card--text{% endif %}
        {% if settings.card_style == 'card' %} color-{{ settings.card_color_scheme }} gradient{% endif %}
        {% if image_shape and image_shape != 'default' %} card--shape{% endif %}
        {% if extend_height %} card--extend-height{% endif %}
        {% if card_product.featured_media == nil and settings.card_style == 'card' %} ratio{% endif %}
        {% if horizontal_class %} card--horizontal{% endif %}
      "
      style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
    >
      <div
        class="card__inner {% if settings.card_style == 'standard' %}color-{{ settings.card_color_scheme }} gradient{% endif %}{% if card_product.featured_media or settings.card_style == 'standard' %} ratio{% endif %}"
        style="--ratio-percent: {{ 1 | divided_by: ratio | times: 100 }}%;"
      >


        <div class="card__body{% if card_product.featured_media or settings.card_style == 'standard' %} ratio-content{% endif %}">
          <div class="card__content">

            <div class="product-card-content">
              <div class="product-title">{{ card_product.title | escape }}</div>
              <div class="product-price">
                {% render 'price', product: card_product, show_compare_at_price: true %}
              </div>
              {% if show_vendor %}
                <div class="product-vendor">{{ card_product.vendor | escape }}</div>
              {% endif %}
              {% if show_rating %}
                <div class="product-rating">
                  {% render 'component-rating', rating: card_product.rating %}
                </div>
              {% endif %}

                    <h3
            class="card__heading{% if card_product.featured_media or settings.card_style == 'standard' %} h5{% endif %}"
            {% if card_product.featured_media or settings.card_style == 'card' %}
              id="title-{{ section_id }}-{{ card_product.id }}"
            {% endif %}
          >
            <a
              href="{{ card_product.url }}"
              id="CardLink-{{ section_id }}-{{ card_product.id }}"
              class="full-unstyled-link"
              aria-labelledby="CardLink-{{ section_id }}-{{ card_product.id }} Badge-{{ section_id }}-{{ card_product.id }}"
            > 
              {{ card_product.title | escape }}
           </a>
          </h3>
            </div>
            
            <div class="popup-button">
              <button class="popup-open button" data-id="{{ card_product.id }}">Popup</button>
            </div>

          </div>
        </div>
      </div>
    </div>

   
 <div class="popup-container" id="popup-{{ card_product.id }}">
  <div class="popup-container-content">
    <div class="image-container">
      <img class="popup-container-image" src="{{ card_product.featured_media | img_url: 'large' }}">
    </div>
    <div class="detail-container">
      <button class="popup-container-close button">Close</button>
      <p class="popup-container-title">{{ card_product.title | escape }}</p>
      <p class="popup-container-price">
        {% render 'price', product: card_product, show_compare_at_price: true %}
      </p>
      <button class="popup-container-sizechart button">Size Chart</button>
    </div>
  </div>
</div>
  </div>
  

  <script>
    document.addEventListener('DOMContentLoaded', function () {
      const modalTriggerButtons = document.querySelectorAll('.popup-open');
      const modalCloseButtons = document.querySelectorAll('.popup-container-close');

      modalTriggerButtons.forEach(function (button) {
        button.addEventListener('click', function () {
          const modalId = button.getAttribute('data-id');
          const modal = document.getElementById(`popup-${modalId}`);

          if (modal) {
            modal.style.display = 'flex';
          }
        });
      });

      modalCloseButtons.forEach(function (button) {
        button.addEventListener('click', function () {
          const modal = button.closest('.popup-container');

          if (modal) {
            modal.style.display = 'none';
          }
        });
      });
    });
  </script>

{% endif %}

 <style>

  .popup-container {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }

  .popup-container-content {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 80%;
    position: relative;
    display: flex;
    align-items: center;
  }

  .popup-container-image {
    max-width: 100%;
    height: auto;
  }

  .popup-container-close {
    width: 20px;
    height: 20px;
    position: absolute;
    top: 10px;
    right: 10px;
    cursor: pointer;
  }

  .popup-container-title {
    font-size: 18px;
    font-weight: bold;
  }

  .popup-container-price {
    font-size: 16px;
    margin-top: 10px;
  }

  .popup-container-sizechart {
    background-color: #007bff;
    color: white;
    border: none;
    padding: 8px 12px;
    border-radius: 4px;
    font-size: 14px;
    cursor: pointer;
  }


  .modal {
    display: none;
    position: fixed;
    top: 0;
    left: 0;
    width: 100%;
    height: 100%;
    background-color: rgba(0, 0, 0, 0.7);
    align-items: center;
    justify-content: center;
    z-index: 9999;
  }

  .modal-content {
    background-color: white;
    padding: 20px;
    border-radius: 8px;
    max-width: 80%;
  }

  .modal-open {
    display: flex;
  }


</style>